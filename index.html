<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>æº«æš–å®ˆè­·</title>
    
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="æº«æš–å®ˆè­·">
    <meta name="mobile-web-app-capable" content="yes">
    <link rel="apple-touch-icon" href="https://via.placeholder.com/180/AEDFF7/ffffff?text=ğŸ¤">

    <style>
        :root { --sky-blue: #AEDFF7; --bg: #FFFDF5; --orange: #FFB74D; --mint: #B2DFDB; --text: #444; }
        
        body { font-family: "Microsoft JhengHei", -apple-system, sans-serif; background: var(--bg); margin: 0; display: flex; justify-content: center; min-height: 100vh; color: var(--text); overflow-x: hidden; -webkit-tap-highlight-color: transparent; }
        
        .screen { 
            width: 100%; max-width: 400px; padding: 25px; box-sizing: border-box;
            display: none; flex-direction: column; align-items: center; opacity: 0; transform: translateY(20px); transition: all 0.4s ease;
        }
        .screen.active { display: flex; opacity: 1; transform: translateY(0); }

        .app-icon { width: 85px; height: 85px; background: var(--sky-blue); border-radius: 25px; display: flex; justify-content: center; align-items: center; font-size: 45px; margin-top: 10px; box-shadow: 0 10px 20px rgba(0,0,0,0.05); }
        
        h1 { font-size: 28px; margin: 20px 0; text-align: center; line-height: 1.4; }
        .sub-text { font-size: 19px; color: #777; margin-bottom: 25px; text-align: center; }

        .btn { 
            width: 100%; padding: 22px; font-size: 24px; font-weight: bold; border: none; border-radius: 22px; 
            margin: 12px 0; cursor: pointer; transition: transform 0.1s; box-shadow: 0 6px 15px rgba(0,0,0,0.08);
        }
        .btn:active { transform: scale(0.95); }
        .btn-mint { background: var(--mint); color: #004D40; }
        .btn-orange { background: var(--orange); color: white; }
        .btn-outline { background: white; border: 3px solid var(--sky-blue); color: #555; }
        .btn-sos { background: #FFAB91; color: #b71c1c; border: 2px solid #ff8a65; margin-top: 20px; }

        .tip-card { background: white; border: 3px solid var(--sky-blue); padding: 25px; border-radius: 28px; margin: 15px 0; width: 100%; box-sizing: border-box; }
        
        .display { font-size: 55px; background: #fff; width: 100%; padding: 20px 0; border-radius: 25px; border: 3px solid var(--sky-blue); margin-bottom: 20px; text-align: center; color: var(--orange); font-weight: bold; letter-spacing: 5px; }
        .keypad { display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; width: 100%; }
        .key { background: white; padding: 22px; font-size: 28px; border-radius: 18px; text-align: center; border: 1px solid #eee; box-shadow: 0 4px 0 #e0e0e0; }
        .key:active { transform: translateY(4px); box-shadow: none; }

        .praise-icon { font-size: 100px; margin: 30px 0; animation: heartBeat 1.5s infinite; }
        @keyframes heartBeat { 0%, 100% { transform: scale(1); } 14%, 42% { transform: scale(1.1); } 70% { transform: scale(1); } }
    </style>
</head>
<body>

    <div id="home" class="screen active">
        <div class="app-icon">ğŸ¤</div>
        <h1>æ—©æ™¨é™³ä¼¯ï¼<br>ä»Šæ—¥è¦ºå¾—é»å‘€ï¼Ÿ</h1>
        <button class="btn btn-mint" onclick="goCheckIn('good')">ä»Šæ—¥å¥½å¥½ â˜€ï¸</button>
        <button class="btn btn-mint" style="background:#FFE0B2; color:#795548;" onclick="goCheckIn('normal')">æœ‰å•²æ”° â˜ï¸</button>
        <button class="btn btn-outline" style="margin-top:20px;" onclick="viewHistory()">ğŸ“‹ ç‡è¿”èˆŠç´€éŒ„</button>
        <button class="btn btn-sos" onclick="triggerSOS()">ğŸ†˜ æµä»”ä»”å¹«å¹«æ‰‹</button>
    </div>

    <div id="tip" class="screen">
        <h1 id="tip-title">å¤ªå¥½å–‡ï¼</h1>
        <div class="tip-card">
            <div id="daily-tip" style="font-size: 22px; line-height: 1.6;"></div>
        </div>
        <p class="sub-text">ä¹–ï¼Œä¸å¦‚é †ä¾¿è¨˜åŸ‹è¡€å£“ï¼Ÿ</p>
        <button class="btn btn-orange" onclick="showScreen('bp')">å¥½ï¼Œå³åˆ»è¨˜ç´€éŒ„ ğŸ“</button>
        <button onclick="location.reload()" style="background:none; border:none; color:#bbb; font-size: 18px; margin-top: 20px;">é²å•²å…ˆï¼Œè¿”ä¸»é </button>
    </div>

    <div id="bp" class="screen">
        <h1 id="bp-label" style="color:var(--orange)">è«‹è¼¸å…¥ã€Œé«˜å£“ã€</h1>
        <div class="display" id="bp-val">---</div>
        <div class="keypad" id="numeric-pad"></div>
    </div>

    <div id="finish" class="screen">
        <div class="praise-icon">ğŸ’</div>
        <h1 id="praise-msg" style="color:var(--orange);"></h1>
        <p id="ending-msg" style="font-size: 22px; color: #666; text-align: center;"></p>
        <button class="btn btn-mint" onclick="location.reload()" style="margin-top:50px; width:90%">è¿”ä¸»é ä¼‘æ¯</button>
    </div>

    <script>
        function vibrate(ms = 50) { if (navigator.vibrate) navigator.vibrate(ms); }

        const tips = [
            "ä»Šæ—¥å¤©æ°£è½‰æ¶¼ï¼Œå‡ºé–€è¨˜å¾—å¸¶ä»¶å¤–å¥—å‘€ï¼ğŸ§¤",
            "è¨˜å¾—é£²å¤šå…©æ¯æš–æ°´ï¼Œå°èº«é«”å¥½å•²ã€‚ğŸ’§",
            "èµ·åºŠå””å¥½å¤ªæ€¥ï¼Œå–ºåºŠé‚Šåä¸€é™£å…ˆè½åºŠã€‚ğŸ›Œ",
            "ä»”ä»”è©±è¦‹åˆ°ä½ æ¯æ—¥æœ‰ç´€éŒ„ï¼Œä½¢å¥½å®‰å¿ƒï¼ğŸ‘¨â€ğŸ‘©â€ğŸ‘§"
        ];
        const praises = ["é™³ä¼¯ï¼Œä½ ä»Šæ—¥å¥½å»å‘€ï¼", "åšå¾—å¥½ï¼æœ‰ä¹–ä¹–ç…§é¡§è‡ªå·±ã€‚", "ç´€éŒ„å·²ç¶“å‚³é€ä¿¾ä»”ä»”å–‡ã€‚"];

        let bpStage = 1; let currentNum = ""; let systolic = "";

        // åˆå§‹åŒ–éµç›¤
        const pad = document.getElementById('numeric-pad');
        const keys = [1,2,3,4,5,6,7,8,9];
        keys.forEach(k => { pad.innerHTML += `<div class="key" onclick="press(${k})">${k}</div>`; });
        pad.innerHTML += `<div class="key" style="background:#FFEBEE; color:#C62828;" onclick="clearBP()">åˆªé™¤</div>`;
        pad.innerHTML += `<div class="key" onclick="press(0)">0</div>`;
        pad.innerHTML += `<div class="key" style="background:var(--mint); color:#004D40;" onclick="confirmBP()">ç¢ºå®š</div>`;

        function showScreen(id) {
            vibrate(30);
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.querySelectorAll('.screen').forEach(s => s.style.display = 'none');
            const next = document.getElementById(id);
            next.style.display = 'flex';
            setTimeout(() => next.classList.add('active'), 50);
        }

        // é€£çºŒç°½åˆ°é‚è¼¯
        function goCheckIn(status) {
            const today = new Date().toLocaleDateString();
            let data = JSON.parse(localStorage.getItem('warmAppCheckIn') || '{"lastDate":"","count":0}');
            
            if (data.lastDate !== today) {
                data.count += 1;
                data.lastDate = today;
                localStorage.setItem('warmAppCheckIn', JSON.stringify(data));
                vibrate([100, 50, 100]);
            }

            document.getElementById('tip-title').innerText = `ç¬¬ ${data.count} æ—¥è¦‹åˆ°ä½ ï¼Œ${status === 'good' ? 'å¥½é–‹å¿ƒï¼' : 'åŠ æ²¹å‘€ï¼'}`;
            document.getElementById('daily-tip').innerText = tips[Math.floor(Math.random()*tips.length)];
            showScreen('tip');
        }

        function triggerSOS() {
            vibrate([200, 100, 200]);
            if(confirm("ä¿‚å’ªå³åˆ»æ‰“é›»è©±ä¿¾ä»”ä»”æµå¹«æ‰‹ï¼Ÿ")) { window.location.href = "tel:98765432"; }
        }

        function press(n) { vibrate(20); if(currentNum.length < 3) { currentNum += n; document.getElementById('bp-val').innerText = currentNum; } }
        function clearBP() { vibrate(40); currentNum = ""; document.getElementById('bp-val').innerText = "---"; }

        function confirmBP() {
            if(currentNum === "") return;
            vibrate(60);
            if(bpStage === 1) {
                systolic = currentNum; bpStage = 2; currentNum = ""; 
                document.getElementById('bp-label').innerText = "è«‹è¼¸å…¥ã€Œä½å£“ã€";
                document.getElementById('bp-val').innerText = "---";
            } else {
                const logs = JSON.parse(localStorage.getItem('bpLogs') || '[]');
                logs.unshift({ date: new Date().toLocaleDateString(), time: new Date().toLocaleTimeString(), sys: systolic, dia: currentNum });
                localStorage.setItem('bpLogs', JSON.stringify(logs));
                
                document.getElementById('praise-msg').innerText = praises[Math.floor(Math.random()*praises.length)];
                document.getElementById('ending-msg').innerText = "ä»Šæ—¥å¥åº·ç´€éŒ„å·²è¨˜å¥½ã€‚ç¥ä½ æœ‰å€‹æ„‰å¿«å˜…ä¸‹åˆï¼";
                showScreen('finish');
            }
        }

        function viewHistory() {
            const logs = JSON.parse(localStorage.getItem('bpLogs') || '[]');
            if(logs.length === 0) return alert("æš«æ™‚æœªæœ‰ç´€éŒ„ã€‚");
            alert(`æœ€è¿‘ç´€éŒ„ï¼š${logs[0].date}\nè¡€å£“ï¼š${logs[0].sys} / ${logs[0].dia}`);
        }
    </script>
</body>
</html>
